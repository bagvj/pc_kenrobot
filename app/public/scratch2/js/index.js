"use strict";!function(){function e(e){n()}function t(e){r()}function o(){return i.classList.add("loaded"),setTimeout(function(e){i.querySelector(".loader").remove()},1e3),!0}function n(e){kenrobot.postMessage("app:projectNewOpen","scratch2",e).then(function(e){d=e.extra,l.loadProject(e.data),l.setProjectName(d.name),kenrobot.getUserInfo(),kenrobot.trigger("util","message","打开成功")},function(e){kenrobot.trigger("util","message",{text:"打开失败",type:"error"})})}function r(e){var t=function(t){d.path?l.exportProject(e):kenrobot.trigger("prompt","show",{title:"项目保存",placeholder:"项目名字",callback:function(t){t?(d.name=t,l.setProjectName(d.name),l.exportProject(e)):kenrobot.trigger("util","message",{text:"保存失败",type:"error"})}})};kenrobot.getUserInfo()||e||d.hasShowSave?t():(d.hasShowSave=!0,kenrobot.trigger("save","show",t))}function a(e,t){(t?kenrobot.postMessage("app:projectNewSaveAs",d.name,"scratch2",e):kenrobot.postMessage("app:projectNewSave",d.name,"scratch2",e,d.path)).then(function(e){d=Object.assign(d,e),l.setProjectName(d.name),kenrobot.trigger("util","message","保存成功")},function(e){kenrobot.trigger("util","message",{text:"保存失败",type:"error"})})}function c(){var e=[{key:["ctrl+n","command+n"],callback:function(e){return s("new-project")}},{key:["ctrl+o","command+o"],callback:function(e){return s("open-project")}},{key:["ctrl+s","command+s"],callback:function(e){return s("save-project")}},{key:["ctrl+shift+s","command+shift+s"],callback:function(e){return s("save-as-project")}}];kenrobot.delayTrigger(100,"shortcut","register",e)}function s(e){switch(e){case"new-project":d={},l.newProject();break;case"open-project":n(arguments.length<=1?void 0:arguments[1]);break;case"save-project":r();break;case"save-as-project":r(!0);break;case"undelete":l.undelete();break;case"toggle-samll-stage":l.toggleSmallStage();break;case"toggle-turbo-mode":l.toggleTurboMode();break;case"edit-block-colors":l.editBlockColors()}}var i,l,d={};(function(){function e(e){if(!o&&("onreadystatechange"!==e.type||"complete"===document.readyState)){for(var n=0;n<t.length;n++)t[n].call(document);o=!0,t=null}}var t=[],o=!1;return document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),document.addEventListener("readystatechange",e,!1),window.addEventListener("load",e,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",e),window.attachEvent("onload",e)),function(e){o?e.call(document):t.push(e)}})()(function(){window.kenrobot=window.kenrobot||top.kenrobot,l=document.getElementById("ken-scratch");var n=(i=document.querySelector(".player")).querySelector(".toolbar");window.JSeditorReady=o,kenrobot&&!kenrobot.isPC||n.remove(),kenrobot&&(kenrobot.isPC||(n.querySelector(".open").addEventListener("click",e),n.querySelector(".save").addEventListener("click",t)),kenrobot.view.saveProject=a,c(),kenrobot.on("app","command",s))})}();